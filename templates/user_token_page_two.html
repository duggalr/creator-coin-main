{% extends 'base.html' %}
{% load static %}


{% block content %}

  {% include 'navbar.html' %}

   
  <div class="main-body">

    <div class="animate__animated animate__fadeIn  container">

      <div class="row"> 

        <div class="col-4">
          <!-- <img src="{% static 'images/coin_one.png' %}" class="rounded" width="330" height="330"> -->
          
          {% if user_nft_obj is not None %}
             
            <!-- <div> -->

              <!-- <h4 style="display: inline;" style="padding-top: 10px; font-weight: 900;">
                {{ user_nft_obj.nft_name }}
              </h4> -->
              <!-- |  -->
              <!-- <span style="font-weight: 900;">
                Updated: {{ user_nft_obj.nft_updated_at|date:"Y-m-d" }}
              </span> -->

            <!-- </div> -->
 
            <model-viewer 
              src="{{ user_nft_obj.nft_media_file.url }}"
              ar ar-modes="webxr scene-viewer quick-look" 
              camera-controls
              camera-orbit="250deg 85deg 125%"
              shadow-intensity="1"
              auto-rotate
              rotation-per-second="450%"
              style="width: 340px; height: 340px;" 
              ></model-viewer>

            <!-- <br/> -->
 
            <!-- <button class="btn btn-outline-success rounded-pill" style="font-size: 17px;">
              Launch your NFT
            </button> -->

            <div style="padding-top: 10px;">

              <h4 style="display: inline;" style="font-weight: 800;">
                {{ user_nft_obj.nft_name }}
              </h4>

              <div style="padding-top: 10px;"></div>

              {% if same_user is True %}

                <!-- <button class="btn btn-primary rounded-pill" id="launch-nft">
                  Launch your NFT
                </button> -->
                <a href="{% url 'mint_new_nft_token' profile_id=profile_id %}">Launch your NFT</a>
                &nbsp;
                <a href="{% url 'update_token_form' %}">Edit Token Settings</a>
                
              {% endif %}

            </div>

            <!-- <br/><br/> -->
            <!-- <a href="">Launch your Token!</a> -->
            
            <div style="padding-top: 10px;">

              <div class="progress">
                <div class="progress-bar progress-bar-striped progress-bar-animated bg-info" role="progressbar" aria-label="Example with label" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                  0%
                </div>
              </div>

            </div>

            <p style="font-size: 18px;">

              <strong>Total Supply:</strong> {{ user_nft_obj.nft_total_supply }} 
              |
              <strong>Price:</strong> {{ user_nft_obj.nft_price }} ETH

            </p>

              
          {% else %}

            <model-viewer 
            src="{% static '3d_model/placeholder_new.glb' %}"  
            ar ar-modes="webxr scene-viewer quick-look" 
            camera-orbit="250deg 85deg 125%"
            camera-controls
            shadow-intensity="1"
            auto-rotate
            rotation-per-second="550%"
            style="width: 300px; height: 300px;" 
            ></model-viewer>

          {% endif %}
    

          {% if user_nft_obj is not None %}

            <!-- TODO: add progress-bar, etc. -->
            
            <!-- <span class="badge rounded-pill text-bg-secondary" style="font-size: 14px;">
              Active NFT Sale!
            </span> -->

          {% else %}

            {% if same_user is True %}
              <span class="badge rounded-pill text-bg-secondary" style="font-size: 14px;">
                No active NFT sale. Maybe you should launch one?
              </span>
            {% else %}
              <span class="badge rounded-pill text-bg-secondary" style="font-size: 15px;">
                User does not have a NFT for sale at the moment.
              </span>
            {% endif %}

          {% endif %}


        </div>
        

        <div class="col-8" id="project-text-main">

          <div class="project-header">

            {% if creator_profile.creator_name is not None and creator_profile.creator_name != '' %}
              <h2 class="project-title">
                {{ creator_profile.creator_name }}
              </h2>
              
              {% if creator_profile.creator_email is not None and creator_profile.creator_email != '' %}
                <span style="font-size: 18px;">
                  | {{ creator_profile.creator_email }}
                </span>
              {% endif %}

            {% else %}
              {% if same_user is True %}
                <h2 class="project-title">
                  Add a name/username?
                </h2>
              {% else %}
                <h2 class="project-title">
                  No Name
                </h2>
              {% endif %}
            {% endif %}
            
            
            <!-- TODO: for same user, just display edit here; also display purchase, they should be able to purchase there own -->
            <!-- <div style="margin-left: auto;">              
              <button type="button" id="project-fund-button" class="btn btn-outline-info rounded-pill">Purchase</button>
              &nbsp;
              <a href='#'>Edit Page</a>
            </div> -->

            <!-- <div style="margin-left: auto;">
            </div> -->


            <div style="margin-left: auto;">  
              
              {% if same_user is True %}

                <a href="{% url 'edit_user_profile' profile_id=profile_id %}" class="btn btn-outline-dark rounded-pill" role="button">
                  Edit Profile
                </a>

                <!-- <a href="{% url 'create_token_form' %}" class="btn btn-outline-info rounded-pill" role="button">
                  Create your NFT
                </a> -->

                {% if user_nft_obj is not None %}

                  <!-- TODO: anything needed here? -->

                  <!-- <button class="btn btn-primary rounded-pill">
                    Launch your NFT
                  </button> -->

                {% else %}

                  <button id="user_create_nft" class="btn btn-outline-info rounded-pill">
                    Create your NFT
                  </button>

                {% endif %}                


              {% else %}

                <!-- <span class="badge rounded-pill text-bg-info" style="font-size: 14px;">
                  No active token sale at the moment
                </span> -->
              
              {% endif %}

              <!-- {% if github_profile is None %}
                <a href="{% url 'github_login' %}" class="btn btn-secondary">
                  <i class="fa fa-github fa-fw"></i>
                  <span>Add your Github</span>
                </a>
              {% endif %} -->
              
              <!-- <button onclick="deployToken()">Deploy Token</button>
              <button onclick="getBalance()">Buy</button>
              <button onclick="mintToken()">Mint Token</button> -->
            
            </div>


          </div>



          <div class="project-subheading-information">
            
            {% if github_profile is not None %}
                
              <span>
                <i class="bi bi-github"></i> <a href="{{ github_profile.github_profile_url }}">Github</a>
                <!-- <i class="bi bi-check-circle" rel="tooltip" title="" id="blah"></i> -->
                <i style="color: skyblue;" class="bi bi-check-circle" data-bs-toggle="tooltip" data-bs-placement="top" title="Github Verified by User."></i>
              </span>

            {% else %}

              <!-- <span style="padding-left: 12px;">
                <i class="bi bi-link"></i> <a href="">
                  add a personal website
                </a>
              </span> -->

              {% if same_user is True %}

                <span>
                  <i class="bi bi-github"></i> 
                  <a href="{% url 'github_login' %}">
                    add your github
                  </a>
                </span>
              
              {% else %}

                <span>
                  <i class="bi bi-github"></i>
                  User did not link his github.
                </span>

              {% endif %}


            {% endif %}


            {% if creator_profile.creator_personal_website|length > 0 and creator_profile.creator_personal_website is not None %}

              <span style="padding-left: 12px;">
                <i class="bi bi-link"></i> <a href="{{ creator_profile.creator_personal_website }}">
                  Personal Website
                </a>
              </span>

            {% else %}

              {% if same_user is True %}
                
                <span style="padding-left: 12px;">
                  <i class="bi bi-link"></i> <a href="{% url 'edit_user_profile' profile_id=profile_id %}">
                    add your personal website
                  </a>
                </span>

              {% endif %}

            {% endif %}


            {% if creator_profile.creator_discord_website|length > 0 and creator_profile.creator_discord_website is not None %}

              <span style="padding-left: 12px;">
                <i class="bi bi-discord"></i> 
                <a href="{{ creator_profile.creator_discord_website }}">
                  Discord
                </a>
              </span>  

            {% else %}

              {% if same_user is True %}
 
                <span style="padding-left: 12px;">
                  <i class="bi bi-discord"></i> 
                  <a href="{% url 'edit_user_profile' profile_id=profile_id %}">
                    add your discord
                  </a>
                </span> 

              {% endif %}

            {% endif %}


            <!-- {% if same_user is True %}

              <span >
                <i class="bi bi-link"></i> <a href="">
                  add a personal website
                </a>
              </span>

              <span style="padding-left: 12px;">
                <i class="bi bi-discord"></i> 
                <a href="">
                  add a discord for your community
                </a>
              </span> 

            {% else %}

              {% if creator_profile.github_website is not none %}
                <span >
                  <i class="bi bi-github"></i> <a href="{{ creator_profile.github_webite }}">Github</a>
                </span>
              {% else %}
                <span>
                  <i class="bi bi-github"></i>
                  Creator has not linked their Github
                </span>

              {% endif %}
              
              {% if creator_profile.project_website is not none %}
                <span>
                  <i class="bi bi-link"></i> <a href="{{ creator_profile.project_website }}">Personal Website</a>
                </span>
                {% endif %}

              {% if creator_profile.discord_website is not none %}
                <span style="padding-left: 12px;">
                  <i class="bi bi-discord"></i> <a href="{{ creator_profile.discord_website }}">Discord</a>
                </span> 

              {% endif %}

            {% endif %} -->
            

            <!-- <div id="project-progress-bar" class="progress">
              <div class="progress-bar progress-bar-striped progress-bar-animated bg-info" role="progressbar" style="width: 30%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">30%</div>
            </div> -->
            
          </div>

          <div class="project-desc">  

            <p>

              {% if creator_profile.creator_description is not None and creator_profile.creator_description != '' %}
                {{ creator_profile.creator_description }}
              {% else %}

                {% if same_user is True %}
                  <b>Add a brief description for the project(s) you are currently working on.</b>
                  You can always provide further details and updates in the project log, below.
                  <br/>
                  
                {% else %}
                  <b>The creator did not seem to create a description.</b>
                {% endif %}

              {% endif %}
           
              <!-- Writing about something, even something you know well, usually shows you that you didn't know it as well as you thought. 
              Putting ideas into words is a severe test. The first words you choose are usually wrong; you have to rewrite sentences over and over to 
              get them exactly right. And your ideas won't just be imprecise, but incomplete too. Half the ideas that end up in an essay will be ones 
              you thought of while you were writing it. Indeed, that's why I write them. 
              Now, how did I come to do this study? At Los Alamos I was brought in to run the computing machines which other people had 
              got going, so those scientists and physicists could get back to business. -->

            </p>

          </div>

          
        </div>


      </div>

      <br/>

      {% include 'project_page_navbar.html' %}



    </div>

  </div>



  <!-- Nft Verification Modal: when user doesn't complete all their profile information -->
  <div class="modal" tabindex="-1" id="nftVerificationModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"> &#129488; Couple steps remaining </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>
            Before creating a NFT, you must <b>complete</b> the following 2 steps:
            <ul>
              <li>Add your name by going to <a href="{% url 'edit_user_profile' profile_id=profile_id %}">edit profile.</a> Also, add a nice description while your at it!</li>
              <li>Add your github.</li> 
            </ul>
            &#127882; <b>I know your excited</b>, and based on historical data, the above steps should only take you ~30 seconds to complete. 
          </p>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>

      </div>
    </div>
  </div>

  <br/>




  <script>

    const nftVerificationModal = new bootstrap.Modal('#nftVerificationModal')

    $( "#user_create_nft" ).click(function() {
      
      // Verify profile details
      $.ajax({
        url: "{% url 'verify_user_profile' %}",
        success: function (response) {
          console.log('res:', response);
          
          if (response['success'] === false){

            nftVerificationModal.show();

          } else if (response['success'] === true){

            window.location.href = 'http://127.0.0.1:7500/create-nft'

          }

        }

      })

      
    });


    // $( "#launch-nft" ).click(function() {

    //   window.location.href = ''

    // })

    


  </script>



{% endblock %}  








